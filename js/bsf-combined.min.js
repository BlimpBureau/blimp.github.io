$(function(){new AnimOnScroll(document.getElementById("grid"),{minDuration:.4,maxDuration:.7,viewportFactor:.2})});(function(e){"use strict";function i(e,t){for(var n in t)e[n]=t[n];return e}function o(e){return s.call(e)==="[object Array]"}function u(e){var t=[];if(o(e))t=e;else if(typeof e.length=="number")for(var n=0,r=e.length;n<r;n++)t.push(e[n]);else t.push(e);return t}function a(e,s){function o(e,n,r){if(!(this instanceof o))return new o(e,n);typeof e=="string"&&(e=document.querySelectorAll(e));this.elements=u(e);this.options=i({},this.options);typeof n=="function"?r=n:i(this.options,n);r&&this.on("always",r);this.getImages();t&&(this.jqDeferred=new t.Deferred);var s=this;setTimeout(function(){s.check()})}function f(e){this.img=e}o.prototype=new e;o.prototype.options={};o.prototype.getImages=function(){this.images=[];for(var e=0,t=this.elements.length;e<t;e++){var n=this.elements[e];n.nodeName==="IMG"&&this.addImage(n);var r=n.querySelectorAll("img");for(var i=0,s=r.length;i<s;i++){var o=r[i];this.addImage(o)}}};o.prototype.addImage=function(e){var t=new f(e);this.images.push(t)};o.prototype.check=function(){function s(s,o){e.options.debug&&r&&n.log("confirm",s,o);e.progress(s);t++;t===i&&e.complete();return!0}var e=this,t=0,i=this.images.length;this.hasAnyBroken=!1;if(!i){this.complete();return}for(var o=0;o<i;o++){var u=this.images[o];u.on("confirm",s);u.check()}};o.prototype.progress=function(e){this.hasAnyBroken=this.hasAnyBroken||!e.isLoaded;this.emit("progress",this,e);this.jqDeferred&&this.jqDeferred.notify(this,e)};o.prototype.complete=function(){var e=this.hasAnyBroken?"fail":"done";this.isComplete=!0;this.emit(e,this);this.emit("always",this);if(this.jqDeferred){var t=this.hasAnyBroken?"reject":"resolve";this.jqDeferred[t](this)}};t&&(t.fn.imagesLoaded=function(e,n){var r=new o(this,e,n);return r.jqDeferred.promise(t(this))});var a={};f.prototype=new e;f.prototype.check=function(){var e=a[this.img.src];if(e){this.useCached(e);return}a[this.img.src]=this;if(this.img.complete&&this.img.naturalWidth!==undefined){this.confirm(this.img.naturalWidth!==0,"naturalWidth");return}var t=this.proxyImage=new Image;s.bind(t,"load",this);s.bind(t,"error",this);t.src=this.img.src};f.prototype.useCached=function(e){if(e.isConfirmed)this.confirm(e.isLoaded,"cached was confirmed");else{var t=this;e.on("confirm",function(e){t.confirm(e.isLoaded,"cache emitted confirmed");return!0})}};f.prototype.confirm=function(e,t){this.isConfirmed=!0;this.isLoaded=e;this.emit("confirm",this,t)};f.prototype.handleEvent=function(e){var t="on"+e.type;this[t]&&this[t](e)};f.prototype.onload=function(){this.confirm(!0,"onload");this.unbindProxyEvents()};f.prototype.onerror=function(){this.confirm(!1,"onerror");this.unbindProxyEvents()};f.prototype.unbindProxyEvents=function(){s.unbind(this.proxyImage,"load",this);s.unbind(this.proxyImage,"error",this)};return o}var t=e.jQuery,n=e.console,r=typeof n!="undefined",s=Object.prototype.toString;typeof define=="function"&&define.amd?define(["eventEmitter","eventie"],a):e.imagesLoaded=a(e.EventEmitter,e.eventie)})(window);(function(e){"use strict";function n(){var n=t.clientHeight,r=e.innerHeight;return n<r?r:n}function r(){return e.pageYOffset||t.scrollTop}function i(e){var t=0,n=0;do{isNaN(e.offsetTop)||(t+=e.offsetTop);isNaN(e.offsetLeft)||(n+=e.offsetLeft)}while(e=e.offsetParent);return{top:t,left:n}}function s(e,t){var s=e.offsetHeight,o=r(),u=o+n(),a=i(e).top,f=a+s,t=t||0;return a+s*t<=u&&f-s*t>=o}function o(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);return e}function u(e,t){this.el=e;this.options=o(this.defaults,t);this._init()}var t=e.document.documentElement;u.prototype={defaults:{minDuration:0,maxDuration:0,viewportFactor:0},_init:function(){this.items=Array.prototype.slice.call(document.querySelectorAll("#"+this.el.id+" > li"));this.itemsCount=this.items.length;this.itemsRenderedCount=0;this.didScroll=!1;var t=this;imagesLoaded(this.el,function(){new Masonry(t.el,{itemSelector:"li",transitionDuration:0});if(Modernizr.cssanimations){t.items.forEach(function(e,n){if(s(e)){t._checkTotalRendered();$(e).addClass("shown")}});e.addEventListener("scroll",function(){t._onScrollFn()},!1);e.addEventListener("resize",function(){t._resizeHandler()},!1)}})},_onScrollFn:function(){var e=this;if(!this.didScroll){this.didScroll=!0;setTimeout(function(){e._scrollPage()},60)}},_scrollPage:function(){var e=this;this.items.forEach(function(t,i){!$(t).hasClass("shown")&&!$(t).hasClass("animate")&&s(t,e.options.viewportFactor)&&setTimeout(function(){var i=r()+n()/2;e.el.style.WebkitPerspectiveOrigin="50% "+i+"px";e.el.style.MozPerspectiveOrigin="50% "+i+"px";e.el.style.perspectiveOrigin="50% "+i+"px";e._checkTotalRendered();if(e.options.minDuration&&e.options.maxDuration){var s=Math.random()*(e.options.maxDuration-e.options.minDuration)+e.options.minDuration+"s";t.style.WebkitAnimationDuration=s;t.style.MozAnimationDuration=s;t.style.animationDuration=s}$(t).addClass("animate")},25)});this.didScroll=!1},_resizeHandler:function(){function t(){e._scrollPage();e.resizeTimeout=null}var e=this;this.resizeTimeout&&clearTimeout(this.resizeTimeout);this.resizeTimeout=setTimeout(t,1e3)},_checkTotalRendered:function(){++this.itemsRenderedCount;this.itemsRenderedCount===this.itemsCount&&e.removeEventListener("scroll",this._onScrollFn)}};e.AnimOnScroll=u})(window);